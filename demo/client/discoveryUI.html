<!DOCTYPE html>
<html dir="ltr" lang="en-US">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Webinos RPC Module Discovery</title>
		<script type="text/javascript" src="../rpc.js"></script>
		<script type="text/javascript" src="../webinos.utils.js"></script>
		<script type="text/javascript" src="/client/webinos.js"></script>
		<script type="text/javascript" src="/messagehandler.js"></script>
		<script type="text/javascript" src="/client/get42.js"></script>
		<script type="text/javascript" src="/client/jsrender.js"></script>
		<link rel="stylesheet" type="text/css" href="/client/jquery-ui-1.8.16.custom.css"/>
		<link rel="stylesheet" type="text/css" href="style.css" media="screen"/>
		<script type="text/javascript" src="/client/jquery.js"></script>
		<script type="text/javascript" src="/client/jquery-ui.js"></script>
		<script type="text/javascript" src="/client/dojo.js"></script>
		
		<!-- add client side *.js in the list. Not sure if included the right files for TV, contacts, devicestatus...
		TODO: currently these .js files are all over the place. Need to create a script to get a list of
		these files when git structure is clear -->  
		
		<script type="text/javascript" src= "./contacts/contacts.js"></script>
		<script type="text/javascript" src="./webinos.js"></script>
		<script type="text/javascript" src="./webinos.sensors.js"></script>       
		<script type="text/javascript" src="./webinos.file.js"></script>
		<script type="text/javascript" src= "/get42.js"></script>
		<script type="text/javascript" src= "../../API/DeviceStatus/src/client/RPC/webinos.client.devicestatus.js"></script>
		<script type="text/javascript" src= "../../API/DeviceStatus/src/client/RPC/client.js"></script>
		<script type="text/javascript" src= "../tv/consumer/webinos.client.tv.js"></script>
		<script type="text/javascript" src= "../tv/consumer/client.js"></script>
		<script type="text/javascript" src= "../UserProfile/Client/UserProfileClient.js"></script>
		
	</head>
	
	<body>
	<h1>Webinos RPC Module Discovery</h1>
	<!--<p>Enter Service you are looking for:   </p>-->
	<div> PZH PZP LIST : <select id="pzh_pzp_list"> <option> </option> </select> <br> </div>
	
	<p> <label>Search Service: </label> </p>
        <p> <input type="text" id="Service" /> <INPUT TYPE="submit" onclick="findservice()" name="FindService" VALUE="Start"></p>
	<footer> Note: supported search formats: *, *c, *c* and full API name. "c" could be any character(s) here.</p>
		
	<p> Service Found :</p>
	
	<select id='servicelist' size="15" multiple="multiple">

        <OPTION VALUE="no service selected">No Service Selected</OPTION>

	</select>
	
	<p> <INPUT TYPE="submit" onclick="bindservice()" name="BindService" VALUE="Bind Service"> </p>
	
	</body>
	
	<script type="text/javascript">
	
		var serviceType;
	
		function changeHandler(event)
		{
			var index;
			index = this.selectedIndex;

			if (index >= 0 && this.options.length > index)
			{
				// Get the new value
  				serviceType = this.options[index].value;
 			}
 			console.log("serviceType:" + serviceType);
     		return serviceType;
		}

		if (servicelist.addEventListener) 
		{
  			// DOM2 standard
  			servicelist.addEventListener("change", changeHandler, false);
		}
		else if (servicelist.attachEvent) 
		{
  			// IE fallback
  			servicelist.attachEvent("onchange", changeHandler);
		}
		else 
		{
  			// DOM0 fallback
  			servicelist.onchange = changeHandler;
		}		
	
		function emptyList( box ) {
			box.options.length = 1;
		}

		function fillList( box, arr0, arr1 ) {
			// arr[0] holds the display text
			// arr[1] are the values

			for ( i = 0; i < arr0.length; i++ ) {

				option = new Option( arr0[i], arr1[i] );
				box.options[box.length] = option;
			}

			// Preselect option 0
			box.selectedIndex=0;
		}
		
		function findservice() {
			var textarray = [];
			var valuearray = []; 
			
			var val = document.getElementById('Service').value;
			console.log("val:" + val); 
			var address = $('#pzh_pzp_list').val();
			// "*", "*temper*", http://webinos.org/api/sensors.temperature
			webinos.ServiceDiscovery.findServices(address, new ServiceType(val), {onFound: function (service) {
			
			emptyList(servicelist);
			textarray.push(service.api);
			valuearray.push(service.api);
			fillList(servicelist, textarray, valuearray);	
           }});
		}
		
		function bindservice(){
		    alert("You've chosen to bind service:  " + serviceType);
		}	
		
	</script>

	<hr />
	<a
		href="mailto:ziran.sun@samsung.com">ziran.sun@samsung.com</a>
</html>


