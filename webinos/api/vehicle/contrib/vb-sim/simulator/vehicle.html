<html>
<head>
	<title>webinos | vehicle simulator</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="icon" href="webinos.ico" type="image/x-icon">
	<link rel="stylesheet" type="text/css" href="style.css" media="screen"/>
	<script type="text/javascript" src="jquery-1.6.4.min.js"></script>
	<script src="iphone-style-checkboxes.js" type="text/javascript" charset="utf-8"></script>
  <link rel="stylesheet" href="switch.css" type="text/css" media="screen" charset="utf-8" />
	<script type="text/javascript" src="http://localhost:9898/nowjs/now.js"></script>
	<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
	<script type="text/javascript">
		now.ready(function(){ 
			$('#inputGear').removeAttr('disabled');
		});
	
		$(document).ready(function() {
		
			 $(':checkbox').iphoneStyle();
			 
			if(navigator.geolocation){
				$('#myLocation').removeAttr('disabled');
			}
			$('#inputGear').change(function(){
				now.setGear($('#inputGear').val());	
			});
			
			$('#setTripComputer').click(function(){
				var tcData = new Object();
				tcData.c1 = $('#tc-c1').val();
				tcData.c2 = $('#tc-c2').val();
				tcData.s1 = $('#tc-s1').val();
				tcData.s2 = $('#tc-s2').val();
				tcData.d = $('#tc-d').val();
				tcData.m = $('#tc-m').val();
				tcData.r = $('#tc-r').val();
				now.setTripComputer(tcData);	
			});

			$('#setPsFront').click(function(){
				var psData = new Object();
				psData.ol = $('#pf-ol').val();
				psData.l = $('#pf-l').val();
				psData.ml = $('#pf-ml').val();
				psData.mr = $('#pf-mr').val();
				psData.r = $('#pf-r').val();
				psData.or = $('#pf-or').val();
				now.setPsFront(psData);	
			});

			$('#setPsRear').click(function(){
				var psData = new Object();
				psData.ol = $('#pr-ol').val();
				psData.l = $('#pr-l').val();
				psData.ml = $('#pr-ml').val();
				psData.mr = $('#pr-mr').val();
				psData.r = $('#pr-r').val();
				psData.or = $('#pr-or').val();
				now.setPsRear(psData);	
			});
			$('#locateOnMap').click(function(){
				var address = $('#d-street').val() + " " + $('d-streetnumber').val() + ", " + $('#d-city').val() + ", " + $('#d-country').val();
				geocoder.geocode( { 'address': address}, handleGeocoder);
			});
			
			$('#setDestinationReached').click(function(){
				now.setDestinationReached(getAdressData());
			});
			$('#setDestinationCancelled').click(function(){
				now.setDestinationCancelled(getAdressData());
			});
			$('#setDestinationChanged').click(function(){
				now.setDestinationChanged(getAdressData());
			});
			
			
			function getAdressData(){
				var data = new Object();
				data.street = $('#d-street').val();
				data.streetnumber = $('#d-streetnumber').val();
				data.country = $('#d-country').val();
				data.city = $('#d-city').val();
				data.postalcode = $('#d-postalcode').val();
				data.premises = $('#d-premises').val();
				data.region = $('#d-region').val();
				data.county = $('#d-county').val();
				data.additionals = '';
				return data;
			}
			$('#myLocation').click(function(){
				navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
				
				function successFunction(pos) {
 					console.log(pos);
 					
    				position = new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
    				marker.setPosition(position);
    				map.setCenter(position);
    				$('#c-lat').val(position.lat());
    				$('#c-lng').val(position.lng());
    				geocoder.geocode({'latLng': position}, handleReversedGeocoder);
 				}
 				
 				function errorFunction(position) {
				    alert('Error!');
				}


			});
						
			initializeMap();
		
		
		});
		
  var centerPoint = new google.maps.LatLng(48.1794411, 11.529219399999988);
  var markerPoint = new google.maps.LatLng(48.1794411, 11.529219399999988);
  var marker;
  var position;
  var map;
  var geocoder;
  function initializeMap() {
    var mapOptions = {
      zoom: 13,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      center: centerPoint
    };

    map = new google.maps.Map(document.getElementById("map_canvas"),
            mapOptions);
    geocoder = new google.maps.Geocoder();
    marker = new google.maps.Marker({
      map:map,
      draggable:true,
      animation: google.maps.Animation.DROP,
      position: markerPoint
    });
    google.maps.event.addListener(marker, 'dragend', handleNewPosition);
  }

	function handleNewPosition(){
    	position = marker.getPosition();
    	$('#c-lat').val(position.lat());
    	$('#c-lng').val(position.lng());
    	geocoder.geocode({'latLng': position}, handleReversedGeocoder);
    }	
   	 
   	function updateAddress(address){
   	 		for(var i = 0; i < address.address_components.length; i++){
				var component = address.address_components[i];
				switch(component.types[0]){
					case 'street_number':
						$('#d-streetnumber').val(component.long_name);
						break;
					case 'route':
						$('#d-street').val(component.long_name);
						break;
					case 'country':
						$('#d-country').val(component.long_name);
						break;
					case 'postal_code':
						$('#d-postalcode').val(component.long_name);
						break;
					case 'postal_code':
						$('#d-postalcode').val(component.long_name);
						break;
						
					case 'administrative_area_level_1': //STATES
						$('#d-region').val(component.long_name);
						break;

			
					case 'administrative_area_level_3': //COUNTIES				
						$('#d-county').val(component.long_name);
						break;
					
							
					case 'administrative_area_level_2': //COUNTIES				
						$('#d-county').val(component.long_name);
						break;


						
					case 'locality': //CITY				
						$('#d-city').val(component.long_name);
						break;
					
					case 'premise': //COUNTIES				
						$('#d-premises').val(component.long_name);
						break;
					
					}
         	}
   	 
   	 }

   	 function handleReversedGeocoder(results, status){
   	 	if (status == google.maps.GeocoderStatus.OK) {
          if (results[0]) {
         	updateAddress(results[0]);
          }
        } else {
          alert("Geocoder failed due to: " + status);
        }
   	 }
   	 
   	 function handleGeocoder(results, status){
		if (status == google.maps.GeocoderStatus.OK) {
          if (results[0]) {
         	
         	updateAddress(results[0]);
         	centerPoint = new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng());
         	map.setCenter(centerPoint);
         	marker.setPosition(centerPoint);
         	$('#c-lat').val(centerPoint.lat());
         	$('#c-lng').val(centerPoint.lng());
         	//updateMarker();
          }
        } else {
          alert("Geocoder failed due to: " + status);
        }
   	 
   	 }
	</script>
</head>
	
<body>
<div id="content" class='content cf'>
	<div id="header">
		<h1><img src="testbed_logo.png"></h1>
     </div>
     <div id="functions">
	<h3>Gear</h3>
	<p><label class='select'>Gear: </label>
	<select id="inputGear" disabled>
				<option value=''></option>
				<option value='0'>R</option>
				<option value='10'>P</option>
				<option value='11'>N</option>
				<option value='1'>1</option>
				<option value='2'>2</option>
				<option value='3'>3</option>
				<option value='4'>4</option>
				<option value='5'>5</option>
				<option value='6'>6</option>
			</select>
			
	</p>
	<h3>Tripcomputer</h3>
	<p><label>Avg. Speed 1:</label><input type='text' value='48.5' id='tc-s1'></p>
	<p><label>Avg. Speed 2:</label><input type='text' value='46.5' id='tc-s2'></p>
	<p><label>Avg. Consumption 1:</label><input type='text' value='5.7' id='tc-c1'></p>
	<p><label>Avg. Consumption 2:</label><input type='text' value='6.1' id='tc-c2'></p>
	<p><label>Mileage:</label><input type='text' value='11298' id='tc-m'></p>
	<p><label>Range:</label><input type='text' value='1230.2' id='tc-r'></p>
	<p><label>Distance:</label><input class='input' type='text' value='33.3' id='tc-d'></p>
	<input type='button' id='setTripComputer' value="Set Tripcomputer"/>
	
	<h3>Parksensors Front</h3>
	<p><label>OutLeft:</label><input type='text' value='255' id='pf-ol'></p>
	<p><label>Left:</label><input type='text' value='255' id='pf-l'></p>
	<p><label>MidLeft:</label><input type='text' value='255' id='pf-ml'></p>
	<p><label>MidRight:</label><input type='text' value='255' id='pf-mr'></p>
	<p><label>Right:</label><input type='text' value='255' id='pf-r'></p>
	<p><label>OutRight:</label><input type='text' value='255' id='pf-or'></p>
	<input type='button' id='setPsFront' value="Set Parksensors Front"/>

	<h3>Parksensors Rear</h3>
	<p><label>OutLeft:</label><input type='text' value='255' id='pr-ol'></p>
	<p><label>MidLeft:</label><input type='text' value='255' id='pr-ml'></p>
	<p><label>MidRight:</label><input type='text' value='255' id='pr-mr'></p>
	<p><label>Right:</label><input type='text' value='255' id='pr-r'></p>
	<p><label>OutRight:</label><input type='text' value='255' id='pr-or'></p>
	<input type='button' id='setPsRear' value="Set Parksensors Rear"/>

	<h3>Lights (in progress) </h3>
	<p><label class='box'>Signal left: </label><input type="checkbox" id="l-singal-left" /></p>
	<p><label class='box'>Signal right: </label><input type="checkbox" id="l-singal-right" /></p>
	<p><label class='box'>Signal warn: </label><input type="checkbox" id="l-singal-warn" /></p>
	<p><label class='box'>Parking: </label><input type="checkbox" id="l-parking" /></p>
	<p><label class='box'>Head: </label><input type="checkbox" id="l-head" /></p>
	<p><label class='box'>Hibeam: </label><input type="checkbox" id="l-hibeam" /></p>
	<p><label class='box'>Fog front: </label><input type="checkbox" id="l-fog-front" /></p>
	<p><label class='box'>Fog rear: </label><input type="checkbox" id="l-fog-rear" /></p>
	
	
	<h3>Wipers (in progress)</h3>
		<p><label class='box'>Front Wash: </label><input type="checkbox" id="w-front-wash" /></p>
	<p><label class='box'>Rear Wash: </label><input type="checkbox" id="w-rear-wash" /></p>
	<p><label class='box'>Wiper auto: </label><input type="checkbox" id="w-automatic" /></p>
	<p><label class='box'>Wiper front once: </label><input type="checkbox" id="w-front-once" /></p>
	<p><label class='box'>Wiper rear once: </label><input type="checkbox" id="w-rear-once" /></p>
	<p><label class='box'>Wiper front level 1 </label><input type="checkbox" id="w-front-level1" /></p>
	<p><label class='box'>Wiper front level 2 </label><input type="checkbox" id="w-front-level2" /></p>
	
	<h3>Climate Control (in progress)</h3>
	<p><label class='select'>Zone: </label>
	<select id="climate_zone">
				<option value=''></option>
				<option value='climate-all'>overall</option>
				<option value='climate-driver'>driver</option>
				<option value='climate-passenger-front'>passenger-front</option>
				<option value='climate-passenger-rear-left'>rear-left</option>
				<option value='climate-passenger-rear-right'>rear-right</option>
			</select>
	</p>
	<p><label>Desired Temp: </label><input type='text' value='255' id='climate-temp'>
	</p>
	<p><label >Vent Level: </label><input type='text' value='255' id='climate-ventlevel'></p>
	<p><label class='box'>AC: </label><input type="checkbox" id="cimate-ac" />
	</p>
	<p><label class='box'>Vent Auto: </label><input type="checkbox" id="climate-vent" />
	</p>
	
	<input type='button' id='setClimate' value="Set Climate" disabled/>
	</p>


	</div>
	<div id="info">
		<h3>Mapsfeatures</h3>
		<div id="map_canvas" style="width: 640px; height: 400px;">
		</div>
			<h4>Coordinates</h4>
			<p><label >Latitude:</label><input type='text' value='' id='c-lat'></p>
			<p><label >Longitude:</label><input type='text' value='' id='c-lng'></p>
			<p><label >Altitude:</label><input type='text' value='0' id='c-alt'></p>
			<p><label >Speed:</label><input type='text' value='0' id='c-speed'></p>
			<p><label >Heading:</label><input type='text' value='0' id='c-heading'></p>
			
			<h4>Address</h4>
			<p><label >Country:</label><input type='text' value='Deutschland' id='d-country'></p>
			<p><label >Region:</label><input type='text' value='Bayern' id='d-region'></p>
			<p><label >County:</label><input type='text' value='' id='d-county'></p>
			<p><label >City:</label><input type='text' value='MÃ¼nchen' id='d-city'></p>
			<p><label >Street:</label><input type='text' value='Hanauer Str.' id='d-street'></p>
			<p><label >Streetnumber:</label><input type='text' value='46' id='d-streetnumber'></p>
			<p><label >Premises:</label><input class='input' type='text' value='' id='d-premises'></p>
			<p><label >add. Info:</label><input class='input' type='text' value='' id='d-info'></p>
			<p><label >add. postalCode:</label><input class='input' type='text' value='80992' id='d-postalcode'></p>

		
		
		<h4>Helpers</h4>
		<p><input type='button' id='myLocation' value="Use my current position" disabled/></p>
		<p><input type='button' id='locateOnMap' value="Resolve current address"/></p>
		
		<h4>Navigation Events</h4>
		
		<p><input type='button' id='setDestinationCancelled' value="Destination-changed"/></p>
		<p><input type='button' id='setDestinationReached' value="Destination-reached"/></p>
		<p><input type='button' id='setDestinationChanged' value="Destination-cancelled"/></p>
		
		<h4>Geolocation (in progress)</h4>
			<p><input type='button' id='setLocation' value="Set Geolocation" disabled/></p>
		
	</div>	
	</div>

	<!--<div id='footer'>VEHICLE SIMULATOR</div>-->
</body>


</html>